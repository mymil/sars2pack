---
title: sars2pack
output: 
  rmarkdown::github_document
  #bookdown::html_document2:
    #number_sections: false
    #toc: false
---


# sars2pack

<!-- badges: start -->

<!-- badges: end -->

```{r init} 
knitr::opts_chunk$set(warning=FALSE,message=FALSE, 
                      fig.width=9, fig.height=6, out.width = '100%'
                      )
knitr::opts_knit$set(upload.fun = knitr::imgur_upload)
```

The `sars2pack` R package:

1. Presents unified approach to getting **lots** of COVID-19 data,
2. Provides extensive documentation and usage examples of these datasets,
3. and

## Installation

```{r eval=FALSE}
# If you do not have BiocManager installed:
install.packages('BiocManager')

# Then, if sars2pack is not already installed:
BiocManager::install('seandavi/sars2pack')

# Then, to use:
```

```{r}
library(sars2pack)
```

## Case tracking

```{r worldwide}
ecdc = ecdc_data()
```

```{r}
head(ecdc)
```

```{r results='asis'}
library(dplyr)
top10 = ecdc %>% filter(subset=='deaths') %>% 
    group_by(location_name) %>%
    filter(count==max(count)) %>%
    arrange(desc(count)) %>%
    head(10) %>% select(-starts_with('iso'),-continent,-subset) %>%
    mutate(rate_per_100k = 1e5*count/population_2018)
knitr::kable(
    top10,
    caption = "Reported COVID-19-related deaths in ten most affected countries.",
    format = 'pandoc')
```

Examine the spread of the pandemic throughout the world by examining cumulative deaths
reported for the top 10 countries above.

```{r plotcases}
ecdc_top10 = ecdc %>% filter(location_name %in% top10$location_name & subset=='deaths')
plot_epicurve(ecdc_top10,
              filter_expression = count > 10, 
              color='location_name')
```

Comparing the features of disease spread is easiest if all curves are shifted to 
"start" at the same absolute level of infection. In this case, shift the origin for
all countries to start at the first time point when more than 100 cumulative cases
had been observed. Note how some curves cross others which is evidence of less infection
control at the same relative time in the pandemic for that country (eg., Brazil).

```{r}
ecdc_top10 %>% align_to_baseline(count>100,group_vars=c('location_name')) %>%
    plot_epicurve(date_column = 'index',color='location_name')
```


## Geospatial plotting of data



## Projection models

```{r}
hcpd = healthdata_projections_data()
regs_of_interest = 'Georgia'
library(ggplot2)
pl = hcpd %>%
   dplyr::filter(location_name %in% regs_of_interest) %>%
   ggplot(aes(x=date)) + geom_line(aes(y=mean, color=metric))
# plot the "mean" prediction
pl
# add 95% confidence bounds
pl + geom_ribbon(aes(ymin=lower, ymax=upper, fill=metric), alpha=0.25)
```


## Contributions

Pull requests are gladly accepted on [Github](https://github.com/seandavi/sars2pack).

### Adding new datasets

See the **Adding new datasets** vignette. 

## Similar work

-   <https://github.com/emanuele-guidotti/COVID19>
-   [Top 25 R resources on Novel COVID-19
    Coronavirus](https://towardsdatascience.com/top-5-r-resources-on-covid-19-coronavirus-1d4c8df6d85f)
-   [COVID-19 epidemiology with
    R](https://rviews.rstudio.com/2020/03/05/covid-19-epidemiology-with-r/)
-   <https://github.com/RamiKrispin/coronavirus>
-   [Youtube: Using R to analyze
    COVID-19](https://www.youtube.com/watch?v=D_CNmYkGRUc)
-   [DataCamp: Visualize the rise of COVID-19 cases globally with
    ggplot2](https://www.datacamp.com/projects/870)
-   [MackLavielle/covidix R
    package](https://github.com/MarcLavielle/covidix/)